name: CI

on: 
  workflow_dispatch:

jobs:
  ci:
    runs-on: windows-2019

    steps:
      - uses: actions/checkout@v2
      - name: Download artifact
        uses: dawidd6/action-download-artifact@v2
        with:
          workflow: build_v8.yml
          name: v8_bin
          path: unity/native_src/
      - name: Build plugin
        run: |
          md unity\general\Bin
          cd unity\native_src
          .\make_win64.bat
          copy build64\Release\puerts.dll ..\general\Bin
          dir ..\general\Bin
      - name: Test
        run: |
          cd unity\general\vs2013
          msbuild Puerts.sln
